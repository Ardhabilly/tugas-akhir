<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tampilan informasi ukm</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="CSS & IMG/dataadminstyle.css">
</head>
<body>
    <!-- navbar -->
    <nav class="navbar navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="dashboard admin.html">Projek Sukses</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDarkNavbar" aria-controls="offcanvasDarkNavbar" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="offcanvasDarkNavbar" aria-labelledby="offcanvasDarkNavbarLabel">
            <div class="offcanvas-header">
                <h5 class="offcanvas-title" id="offcanvasDarkNavbarLabel">Menu </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
              <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                <li class="nav-item">
                    <a class="nav-link" aria-current="page" href="dashboard admin.html">Dashboard</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link active dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                      Jenis Unit Kegiatan Mahasiswa
                    </a>
                    <ul class="dropdown-menu dropdown-menu-dark">
                      <li><a class="dropdown-item" href="UKM FKIP Mengajar.html">UKM FKIP Mengajar</a></li>
                      <li><a class="dropdown-item" href="UKM Kopma ULM.html">UKM Kopma ULM</a></li>
                      <li><a class="dropdown-item" href="UKM PSHT ULM.html">UKM PSHT</a></li>
                      <li><a class="dropdown-item nav-link active" href="UKM LDK UKMM ULM.html">UKM LDK UKMM</a></li>
                    </ul>
                  </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="Logout()">Logout</a>
                  </li>
              </ul>
            </div>
          </div>
        </div>
    </nav>
      
      <!-- Logo dan penjelasan sedikit terkait ukm -->
      <h1>UKM LDK UKMM Universitas Lambung Mangkurat</h1>
      <br>
      <img src="https://ldkukmm.ulm.ac.id/wp-content/uploads/2022/06/logo2-new-1.png" alt="UKMM" width="200px" height="200px" style="display: block; margin: auto;">
      <br>
      <table style="margin-left:50px;margin-right:auto">
        <tr>
            <td  width="640px">Ketua Umum : Taufik Hidayat</td>
            <td>Sekertaris Umum : Nor Anisa</td>
        </tr>
        <tr>
            <td  width="640px">Prodi : Administrasi Publik</td>
            <td>Prodi : PG-PAUD</td>
        </tr>
      </table>
      <br>

      <div >
          <p class="div_text">Assalamu’alaikum warahmatullahi wabarakaatuh, Kami mengajak kalian untuk berlari menggapai kebaikan, dan terlebih dimana kita sudah melembagakan diri dalam lembaga dakwah kampus, 
            maka sebuah keniscayaan jika umat menginginkan hal itu. Dan bukanlah tiu juga roh yang selama ini terus membersamai desahan nafas kita dan mengalir bersama aliran darah ini. Kami mengatakan sebuah 
            kekuatan yang terpancang bahwa, kami tidak bermaksud kecuali mendatangkan perbaikan selama kami masih berkesanggupan. Dan sebuah ungkapan yang melekat sangat kuat. Kami adalah da’i sebelum segala sesuatu.
             Kami segenap pengurus inti dan kader LDK UKMM ULM 11 mengucapkan mari menebar kebaikan dalam dakwah, karena tiada kebaikan dalam dakwah, insya allah akan dibalas dengan syurga-Nya.</p>
      </div>
      <p class="div_text">Untuk informasi lebih lanjut silahkan klik : <a href="https://www.instagram.com/p/CqHTL0-P0oK/"><img src="CSS & IMG/image/Instagram.png" alt="IG" width="22px"></a></p>
      <hr>

    <!-- Table data mahasiswa -->
    <h2 class="text_tengah">Data Mahasiswa Pilkom yang Masuk UKM LDK UKMM ULM</h2>
    <div>
        <button class="btn" id="btnTambah">Tambah Data</button>
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>No</th>
                    <th>Nama</th>
                    <th>Nim</th>
                    <th>Prodi</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody id="data">

            </tbody>
        </table>
    </div>

    <!-- tambah data -->
    <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>

            <div>
                <h3 style="text-align: center;">Tambah Data</h3>
                <table style="margin-left:auto;margin-right:auto">
                    <tr>
                        <td><label for="nama">Nama</label></td>
                        <td><input type="text" name="nama" id="nama"></td>
                    </tr>
                    <tr>
                        <td><label for="nim">NIM</label></td>
                        <td><input type="text" name="nim" id="nim"></td>
                    </tr>
                    <tr>
                        <td><label for="prodi">Prodi</label></td>
                        <td><input type="text" name="prodi" id="prodi"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><input type="button" value="Submit" name="submit" id="submit" class="btn"></td>
                    </tr>
                    
                </table>
            </div>
        </div>
    </div>

    <!-- Modal Edit Data -->
    <div id="editModal" class="modal">

        <!-- Modal Content -->
        <div class="modal-content">
            <span class="close">&times;</span>

            <div>
                <h3 style="text-align: center;">Tambah Data</h3>
                <table style="margin-left: auto;margin-right: auto;">
                    <tr>
                        <td><label for="nama">Nama</label></td>
                        <td scope="col"><input type="text" name="nama" id="namaEdit"></td>
                    </tr>
                    <tr>
                        <td><label for="nim">NIM</label></td>
                        <td><input type="text" name="nim" id="nimEdit"></td>
                    </tr>
                    <tr>
                        <td><label for="prodi">Prodi</label></td>
                        <td><input type="text" name="prodi" id="prodiEdit"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><input type="button" value="Submit" name="submit" id="submitEdit" class="btn"></td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    <script src = "CSS & IMG/dataadminjava.js"></script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      

        // TODO: Add SDKs for Firebase products that you want to use
        import { getDatabase, ref, set, push, get, child, onValue, update, remove } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";



        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC2wTeDFKZGcwLYePxgTeW1CgLyiomspAs",
            authDomain: "data-data-f15d7.firebaseapp.com",
            projectId: "data-data-f15d7",
            storageBucket: "data-data-f15d7.appspot.com",
            messagingSenderId: "600110289849",
            appId: "1:600110289849:web:a65d49e335a62ddf79dc68"
        };

      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);


        // inisialisasi tiap inputan
        let nama = document.getElementById('nama');
        let nim = document.getElementById('nim');
        let prodi = document.getElementById('prodi');
        var selectedKey;
        var editModal = document.getElementById('editModal');

        // kerangka isi tbody
        var tbody = document.getElementById('data');
        var no = 0;

        function addItemToTable(key, nama, nim, prodi){
            let trow = document.createElement('tr');

            let table =` 
                        <td>${++no}</td>
                        <td>${nama}</td>
                        <td>${nim}</td>
                        <td>${prodi}</td>
                `
            
            let td = document.createElement('td')

            let btnEdit = document.createElement('button');
            let t = document.createTextNode('Edit');
            btnEdit.id = 'btnEdit';
            btnEdit.classList.add('btn')
            btnEdit.value = key
            btnEdit.appendChild(t);
            btnEdit.addEventListener('click', ()=>{
                editModal.style.display = 'block';
                selectedKey = btnEdit.value;
            })
            btnEdit.onclick = function(){showDataEdit(btnEdit.value)};
            
            let btnHapus = document.createElement('button');
            t = document.createTextNode('Hapus');
            btnHapus.id = 'btnHapus';
            btnHapus.classList.add('btnmerah')
            btnHapus.value = key;
            btnHapus.appendChild(t);
            btnHapus.addEventListener('click', (key)=>{
                hapusData(btnEdit.value)
            })

            trow.innerHTML = table;
            td.appendChild(btnEdit);
            td.appendChild(btnHapus);
            trow.appendChild(td);

            tbody.appendChild(trow);
        }

        function AddAllItemToTable(LDKUKMM){
            no = 0;
            tbody.innerHTML='';
            LDKUKMM.forEach(element => {
                addItemToTable(element.key, element.nama, element.nim, element.prodi);
            })
        }

        // tambah data
        function tambahData(){
            let data = {
                nama: nama.value,
                nim: nim.value,
                prodi: prodi.value
            };

            push(ref(database, 'ldkukmm'), data)
            .then(()=>{
                nama.value = '';
                nim.value = '';
                prodi.value = '';
            })
        }

        // tombol submit data
        document.getElementById('submit').addEventListener('click', tambahData);

        // data
        function getAllDataRealTime(){
            const dbRef = ref(database, 'ldkukmm');
            var tabel = document.getElementById('tabel');

            onValue(dbRef, (snapshot)=>{
                var ldkukmm = []
                snapshot.forEach(childSnapshot =>{
                    let temp = childSnapshot.val();
                    temp['key'] = childSnapshot.key;
                    ldkukmm.push(temp);
                });
            AddAllItemToTable(ldkukmm);
            })
        }
        window.onload = getAllDataRealTime();

        // update data
        var submitEdit = document.getElementById('submitEdit');
        submitEdit.onclick = function(){updateData(selectedKey)};
        
        function updateData(id){
            let data = {
                nama: namaEdit.value,
                nim: nimEdit.value,
                prodi: prodiEdit.value
            };

            update(ref(database, 'ldkukmm/'+id), data)
            .then(()=>{
                namaEdit.value = '';
                nimEdit.value = '';
                prodiEdit.value = '';
                editModal.style.display = 'none'
            });
        }

         // hapus data
         function hapusData(id){
            remove(ref(database, 'ldkukmm/'+id))
            .then(()=>{
            });
        }



        

      </script>
</body>
</html>